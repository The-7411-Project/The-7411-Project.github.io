<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>{{ page.title }}</title>
  <style>
    :root {
      --background-color: #2b2b2b;
      --surface-color: #3c3f41;
      --text-color: #dcdcdc;
      --highlight-color: #4fe1ff;
      --border-color: #4f4f4f;
      --button-color: #8ae234;
      --button-hover-color: #aaff66;
      --link-color: cyan;
      --font-size: 16px;
      --image-scale: 1;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: "Segoe UI", "Ubuntu", "Arial", sans-serif;
      background-color: var(--background-color);
      color: var(--text-color);
      text-align: center;
      font-size: var(--font-size);
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    body.light-mode {
      --background-color: #fefefe;
      --surface-color: #e0e0e0;
      --text-color: #222;
      --highlight-color: #0077cc;
      --border-color: #ccc;
      --button-color: #4caf50;
      --button-hover-color: #81c784;
      --link-color: #0077cc;
      background-color: var(--background-color);
      color: var(--text-color);
    }

    * {
      box-sizing: border-box;
    }

    header {
      background: var(--surface-color);
      padding: 15px 30px;
      border-bottom: 1px solid var(--border-color);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: relative;
    }

    header h1 {
      margin: 0;
      font-size: 1.8em;
      color: var(--highlight-color);
      user-select: none;
      flex-shrink: 0;
    }

    nav {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-grow: 1;
      margin: 0 20px;
    }

    nav a {
      color: var(--link-color);
      text-decoration: none;
      font-weight: bold;
      transition: color 0.3s ease, text-shadow 0.3s ease;
      line-height: 1;
    }

    nav a:hover {
      color: var(--link-color);
      text-shadow: 0 0 8px var(--link-color);
    }

    #settings-toggle {
      width: 28px;
      height: 28px;
      cursor: pointer;
      fill: var(--highlight-color);
      transition: fill 0.3s ease;
      user-select: none;
      flex-shrink: 0;
    }

    #settings-toggle:hover {
      fill: var(--link-color);
    }

    #settings-menu {
      position: absolute;
      top: 60px;
      right: 30px;
      background: var(--surface-color);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      box-shadow: 2px 2px 12px rgba(0,0,0,0.7);
      width: 260px;
      padding: 20px;
      display: none;
      z-index: 100;
      text-align: left;
      color: var(--text-color);
      font-size: 0.9em;
      user-select: none;
    }

    #settings-menu.show {
      display: block;
    }

    #settings-menu label {
      display: block;
      margin-bottom: 10px;
      font-weight: 600;
    }

    #settings-menu input[type="range"] {
      width: 100%;
      margin-bottom: 20px;
    }

    #settings-menu .toggle-container {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      gap: 10px;
    }

    #settings-menu button {
      background-color: var(--button-color);
      color: #000;
      border: none;
      padding: 8px 15px;
      font-size: 1em;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.4);
      transition: background-color 0.3s ease, transform 0.2s ease;
      width: 100%;
    }

    #settings-menu button:hover {
      background-color: var(--button-hover-color);
      transform: scale(1.05);
    }

    main {
      padding: 30px;
      margin: 30px auto;
      max-width: 960px;
      background: var(--surface-color);
      border-radius: 12px;
      border: 1px solid var(--border-color);
      box-shadow:
        inset 1px 1px 3px rgba(255, 255, 255, 0.05),
        2px 2px 8px rgba(0, 0, 0, 0.6),
        4px 4px 20px rgba(0, 0, 0, 0.4);
      text-align: center;
    }

    main a {
      color: var(--link-color);
      text-decoration: none;
      transition: color 0.3s ease, text-shadow 0.3s ease;
    }

    main a:hover, main a:focus, main a:active {
      color: var(--link-color);
      text-shadow: 0 0 8px var(--link-color);
    }

    img {
      display: block;
      margin: 20px auto;
      max-width: 100%;
      height: auto;
      box-shadow:
        0 4px 12px rgba(0, 0, 0, 0.5),
        0 0 0 4px var(--border-color);
      border-radius: 8px;
      transition: transform 0.3s ease;
      transform-origin: center center;
      transform: scale(var(--image-scale));
    }

    img:hover {
      transform: scale(calc(var(--image-scale) * 1.02));
    }

    table {
      width: 100%;
      margin: 20px auto;
      border-collapse: collapse;
      background: var(--surface-color);
      color: var(--text-color);
      border: 1px solid var(--border-color);
      box-shadow: 2px 2px 10px rgba(0,0,0,0.5);
    }

    th, td {
      padding: 12px 16px;
      border: 1px solid var(--border-color);
    }

    th {
      background-color: #4b4e51;
      color: var(--highlight-color);
    }

    tr:nth-child(even) {
      background-color: #383c3e;
    }

    button {
      background-color: var(--button-color);
      color: #000;
      border: none;
      padding: 10px 20px;
      margin: 10px auto;
      font-size: 1em;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.4);
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    button:hover {
      background-color: var(--button-hover-color);
      transform: scale(1.05);
    }

    footer {
      margin-top: 40px;
      font-size: 0.9em;
      color: #aaa;
      text-align: center;
    }
  </style>
</head>
<body>
  <header>
    <h1>{{ site.title | default: "My Site Header" }}</h1>
    <nav>
      <a href="/">Home</a>
      <a href="/about">About</a>
      <a href="/directory">Directory</a>
      <a href="/archive">Archive</a>
    </nav>

    <svg id="settings-toggle" viewBox="0 0 24 24" aria-label="Settings" role="button" tabindex="0" title="Settings" >
      <path d="M19.14 12.94a7.98 7.98 0 000-1.88l2.03-1.58-2-3.46-2.39.96a8.086 8.086 0 00-1.63-1l-.36-2.54H9.24l-.36 2.54a7.86 7.86 0 00-1.63 1l-2.39-.96-2 3.46 2.03 1.58a7.98 7.98 0 000 1.88L3.23 14.5l2 3.46 2.39-.96c.48.38 1 .7 1.63 1l.36 2.54h3.98l.36-2.54c.63-.3 1.15-.65 1.63-1l2.39.96 2-3.46-2.09-1.56zM12 15.5a3.5 3.5 0 110-7 3.5 3.5 0 010 7z"/>
    </svg>

    <div id="settings-menu" role="region" aria-label="Settings Menu" tabindex="-1">
      <label for="font-size-slider">Font Size: <span id="font-size-value">16</span>px</label>
      <input type="range" id="font-size-slider" min="12" max="24" value="16" />

      <div class="toggle-container">
        <input type="checkbox" id="mode-toggle" />
        <label for="mode-toggle">Light Mode</label>
      </div>

      <div class="toggle-container">
        <input type="checkbox" id="images-toggle" checked />
        <label for="images-toggle">Show Images</label>
      </div>

      <label for="image-size-slider">Image Size: <span id="image-size-value">100</span>%</label>
      <input type="range" id="image-size-slider" min="50" max="150" value="100" />

      <button id="settings-close">Close</button>
    </div>
  </header>

  <main>
    {{ content }}
    <footer>7411 Project</footer>
  </main>

  <script>
    const settingsToggle = document.getElementById('settings-toggle');
    const settingsMenu = document.getElementById('settings-menu');
    const fontSizeSlider = document.getElementById('font-size-slider');
    const fontSizeValue = document.getElementById('font-size-value');
    const modeToggle = document.getElementById('mode-toggle');
    const imagesToggle = document.getElementById('images-toggle');
    const imageSizeSlider = document.getElementById('image-size-slider');
    const imageSizeValue = document.getElementById('image-size-value');
    const settingsClose = document.getElementById('settings-close');

    function toggleSettings() {
      settingsMenu.classList.toggle('show');
      if (settingsMenu.classList.contains('show')) {
        settingsMenu.focus();
      }
    }

    settingsToggle.addEventListener('click', toggleSettings);
    settingsToggle.addEventListener('keydown', e => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        toggleSettings();
      }
    });

    settingsClose.addEventListener('click', () => {
      settingsMenu.classList.remove('show');
      settingsToggle.focus();
    });

    fontSizeSlider.addEventListener('input', () => {
      const size = fontSizeSlider.value;
      fontSizeValue.textContent = size;
      document.documentElement.style.setProperty('--font-size', size + 'px');
    });

    modeToggle.addEventListener('change', () => {
      if (modeToggle.checked) {
        document.body.classList.add('light-mode');
      } else {
        document.body.classList.remove('light-mode');
      }
    });

    imagesToggle.addEventListener('change', () => {
      const imgs = document.querySelectorAll('main img');
      imgs.forEach(img => {
        img.style.display = imagesToggle.checked ? 'block' : 'none';
      });
    });

    imageSizeSlider.addEventListener('input', () => {
      const scalePercent = imageSizeSlider.value;
      imageSizeValue.textContent = scalePercent;
      const scale = scalePercent / 100;
      document.documentElement.style.setProperty('--image-scale', scale);
    });

    // Initialize states on page load:
    fontSizeValue.textContent = fontSizeSlider.value;
    document.documentElement.style.setProperty('--font-size', fontSizeSlider.value + 'px');

    imageSizeValue.textContent = imageSizeSlider.value;
    document.documentElement.style.setProperty('--image-scale', imageSizeSlider.value / 100);

    if (modeToggle.checked) {
      document.body.classList.add('light-mode');
    } else {
      document.body.classList.remove('light-mode');
    }

    // Show images toggle checked by default
    const imgs = document.querySelectorAll('main img');
    imgs.forEach(img => {
      img.style.display = imagesToggle.checked ? 'block' : 'none';
    });
  </script>
</body>
</html>
